webpackJsonp([86],{LSmk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("lC5x"),l=a.n(i),n=a("J0Oq"),r=a.n(n),o=a("EuRQ"),s={data:function(){return{Title:"",ids:"",type_id:"",tableData:[],value:"",currentPage:1,limit:10,total:0,visible:!1,rules:{common:[{required:!0,message:"充值金额不合法",trigger:"blur"}]},form:{send_name:"",title:"",content:"",coins:"",uid:[],end_time:"",start_time:""},title:"记录",disabled:!1,disabledName:!1}},created:function(){this.initdata({page:this.currentPage,limit:this.limit,mail_type:1})},methods:{writeEmail:function(){this.editForm("记录",!0,!1,!1,{})},search:function(){""===this.ids?this.ids=0:""===this.type_id&&(this.type_id=0),this.initdata({page:this.currentPage,limit:this.limit,mail_type:1,title:this.Title,ids:+this.ids,type_id:+this.type_id}),this.ids="",this.type_id="",this.Title=""},handleEdit:function(t){(t=Object(o.a)(t)).start_time=this.data(t.start_time),t.end_time=this.data(t.end_time),this.editForm("编辑",!0,!1,!0,t)},detail:function(t){(t=Object(o.a)(t)).start_time=this.data(t.start_time),t.end_time=this.data(t.end_time),this.editForm("邮件详情",!0,!0,!0,t)},del:function(t){var e=this;return r()(l.a.mark(function a(){var i,n,r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.send_status="废弃",i={mail_type:1,send_status:2,mail_id:t.id},a.next=4,e.$http.HallFunConfig.patchEmail(i);case 4:n=a.sent,1===(r=n.data).code&&"ok"===r.msg&&e.initdata({page:e.currentPage,limit:e.limit,mail_type:1});case 7:case"end":return a.stop()}},a,e)}))()},handleSizeChange:function(t){this.limit=t,this.currentPage=1,this.initdata({page:this.currentPage,limit:this.limit,mail_type:1})},handleCurrentChange:function(t){this.currentPage=t,this.initdata({page:this.currentPage,limit:this.limit,mail_type:1})},onSubmit:function(t,e){var a,i=this;this.$refs[t].validate((a=r()(l.a.mark(function t(a){var n,r,s,c,m,d;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=24;break}if("记录"!==e){t.next=11;break}return(n=Object(o.a)(i.form)).mail_type=1,t.next=6,i.$http.HallFunConfig.PostEmail(n);case 6:r=t.sent,1===(s=r.data).code&&"ok"===s.msg&&i.initdata({page:i.currentPage,limit:i.limit,mail_type:1}),t.next=21;break;case 11:if("编辑"!==e){t.next=20;break}return c={send_name:i.form.send_name,title:i.form.title,content:i.form.content,coins:i.form.coins,uid:i.form.uid,mail_type:1,mail_id:i.form.id,start_time:i.form.start_time,end_time:i.form.end_time},t.next=15,i.$http.HallFunConfig.PutEmail(c);case 15:m=t.sent,1===(d=m.data).code&&"ok"===d.msg&&i.initdata({page:i.currentPage,limit:i.limit,mail_type:1}),t.next=21;break;case 20:case 21:i.editForm("记录",!1,!1,!1,{}),t.next=26;break;case 24:return console.log("error submit!!"),t.abrupt("return",!1);case 26:case"end":return t.stop()}},t,i)})),function(t){return a.apply(this,arguments)}))},editForm:function(t,e,a,i,l){this.title=t,this.visible=e,this.disabled=a,this.disabledName=i,this.form=l},formateData:function(t){var e=this;return t.forEach(function(t){var a=e.data(t.start_time),i=e.data(t.end_time),l=Date.parse(new Date);l<a?t.send_status="未生效":l>a&&l<i?t.send_status="生效中":l>i&&(t.send_status="已过期")}),t},data:function(t){var e=Date.parse(t);return new Date(e).getTime()},initdata:function(t){var e=this;return r()(l.a.mark(function a(){var i,n,r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$http.HallFunConfig.GetEmail(t);case 2:i=a.sent,n=i.data,r=e.formateData(n.data),e.tableData=r,e.total=n.total,0===e.total&&e.$message({type:"warning",message:"没有找到合适的数据!"});case 8:case"end":return a.stop()}},a,e)}))()}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"allServersEmail"}},[a("div",{staticClass:"title"},[a("div",{staticClass:"botton"},[a("el-button",{attrs:{type:"primary"},on:{click:t.writeEmail}},[t._v("写邮件")])],1),t._v("\n    邮件ID\n    "),a("el-input",{staticStyle:{"margin-top":"10px",width:"200px"},model:{value:t.ids,callback:function(e){t.ids=e},expression:"ids"}}),t._v("\n\n    标题\n    "),a("el-input",{staticStyle:{"margin-top":"10px",width:"200px"},model:{value:t.Title,callback:function(e){t.Title=e},expression:"Title"}}),t._v("\n    状态\n    "),a("el-select",{staticStyle:{"margin-top":"10px",width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.type_id,callback:function(e){t.type_id=e},expression:"type_id"}},[a("el-option",{attrs:{label:"生效中",value:1}}),t._v(" "),a("el-option",{attrs:{label:"未生效",value:2}}),t._v(" "),a("el-option",{attrs:{label:"已过期",value:3}}),t._v(" "),a("el-option",{attrs:{label:"作废",value:4}})],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查找")])],1),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"","highlight-current-row":"",data:t.tableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"id",label:"邮件序号",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"start_time",label:"创建时间",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"send_name",label:"发件人",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"邮件标题",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"coins",label:"邮件道具(金币)",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"start_time",label:"邮件生效时间",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"end_time",label:"邮件过期时间",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"send_status",label:"邮件状态",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center","show-overflow-tooltip":"",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.detail(e.row)}}},[t._v("详情")]),t._v(" "),"废弃"!==e.row.send_status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.del(e.row)}}},[t._v("废弃")]):t._e()]}}])})],1),t._v(" "),t.total>5?a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10,15,20],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1),t._v(" "),a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{disabled:t.disabled,rules:t.rules,model:t.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"发件人名称",prop:"send_name"}},[a("el-input",{attrs:{disabled:t.disabledName,placeholder:"发件人名称"},model:{value:t.form.send_name,callback:function(e){t.$set(t.form,"send_name",e)},expression:"form.send_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮件标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"邮件标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮件内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"金币",prop:"coins"}},[a("el-input",{attrs:{placeholder:"金币"},model:{value:t.form.coins,callback:function(e){t.$set(t.form,"coins",e)},expression:"form.coins"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"生效时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请输入结束时间",format:"yyyy-MM-dd","value-format":"timestamp"},model:{value:t.form.start_time,callback:function(e){t.$set(t.form,"start_time",e)},expression:"form.start_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"过期时间",prop:"end_time"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请输入结束时间",format:"yyyy-MM-dd","value-format":"timestamp"},model:{value:t.form.end_time,callback:function(e){t.$set(t.form,"end_time",e)},expression:"form.end_time"}})],1)],1),t._v(" "),"邮件详情"!=t.title?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form",t.title)}}},[t._v("确 定")])],1):t._e()],1)],1)])},staticRenderFns:[]};var m=a("C7Lr")(s,c,!1,function(t){a("ipfO")},"data-v-1c034100",null);e.default=m.exports},ipfO:function(t,e){}});
//# sourceMappingURL=86.aaf4d089af1aaf213ad6.js.map