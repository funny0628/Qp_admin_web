webpackJsonp([44],{"69j3":function(e,t){},OSbC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("22Zk"),n=(l.a,{name:"whole_package_update",components:{InputArea:l.a},data:function(){return{loading:!1,currentPage:1,pageSize:10,total:0,dialogTitle:"",formLabelWidth:"120px",dialogFormVisible:!1,dialogVisible:!1,tableData:[],records:[],imageUrl:"",channelOpts:[],form:{version_id:null,channel:"",radio:"1",version:"",package_size:"",package_url:""},form2:{name:""}}},methods:{getWholePackageList:function(){var e=this;this.$http.get("v1/backend/sys-conf/package",{params:{page:this.currentPage,limit:this.pageSize}}).then(function(t){console.log(t),200===t.data.code&&(e.tableData=t.data.data,e.total=t.data.total)})},getAllChannelList:function(){var e=this;this.$http.post("v1/backend/no_channel",{type_id:2,add_id:2}).then(function(t){console.log(t),1===t.data.code&&(e.channelOpts=t.data.data)})},addVersionUpdate:function(){var e=this,t={channel:this.form.channel,version:this.form.version,status:Number(this.form.radio),package_size:100,package_url:"www.baidu.com"};this.$http.post("v1/backend/sys-conf/package",t).then(function(t){console.log(t),200===t.data.code?(e.dialogFormVisible=!1,e.getWholePackageList(),e.$message({type:"success",message:t.data.msg})):(e.dialogFormVisible=!1,e.$message({type:"info",message:t.data.msg}))})},handleHistory:function(e){var t=this;console.log(e),this.loading=!0,this.$http.get("v1/backend/sys-conf/package/history",{params:{page:this.currentPage,limit:this.pageSize,channel:e.channel}}).then(function(e){console.log(e),200==e.data.code&&(t.dialogVisible=!0,t.loading=!1,t.records=e.data.data)})},handleEdit:function(e){console.log(e),this.dialogVisible=!1,this.dialogFormVisible=!0},handleDelete:function(e){var t=this;console.log(e),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.delete("v1/backend/sys-conf/package",{params:{version_id:e.id}}).then(function(e){console.log(e),200===e.data.code&&(t.handleHistory(),t.$message({type:"success",message:e.data.msg}))})}).catch(function(){t.$message({type:"info",message:res.data.msg})})},uploadFile:function(e){var t=e.file;console.log(t);var a=new FormData;a.append("file",t),a.append("file_name",t.name),a.append("package_size",t.size),this.$http.post("v1/backend/sys-conf/package/upload",a).then(function(e){console.log(e)})},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.getWholePackageList()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getWholePackageList()}},mounted:function(){this.getWholePackageList(),this.getAllChannelList()}}),o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"whiteList-main"}},[a("input-area",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"bd"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"version",label:"更新版本",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"channel",label:"更新渠道",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("span",[e._v("启用")]):e._e(),e._v(" "),2==t.row.status?a("span",[e._v("禁用")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"modified_time",label:"更新时间",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:e.loading,expression:"loading",modifiers:{fullscreen:!0}}],attrs:{"element-loading-text":"资源加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)",size:"mini",type:"primary"},on:{click:function(a){return e.handleHistory(t.row)}}},[e._v("历史版本")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.currentPage,"page-sizes":[10,15,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加版本管理信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"渠道","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择渠道"},model:{value:e.form.channel,callback:function(t){e.$set(e.form,"channel",t)},expression:"form.channel"}},e._l(e.channelOpts,function(e,t){return a("el-option",{key:t,attrs:{label:e.channel_name,value:e.channel_code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"更新状态","label-width":e.formLabelWidth}},[a("el-radio",{attrs:{label:"1"},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[e._v("禁用")])],1),e._v(" "),a("el-form-item",{attrs:{label:"文件","label-width":e.formLabelWidth}},[a("el-upload",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:e.loading,expression:"loading",modifiers:{fullscreen:!0}}],attrs:{"element-loading-text":"资源包上传中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)",action:"",accept:".apk","show-file-list":!1,"http-request":e.uploadFile}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("apk/ipa包上传")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"更新版本号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.version,callback:function(t){e.$set(e.form,"version",t)},expression:"form.version"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"包大小(byte)","label-width":e.formLabelWidth}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.form.package_size,callback:function(t){e.$set(e.form,"package_size",t)},expression:"form.package_size"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"整包地址","label-width":e.formLabelWidth}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.form.package_url,callback:function(t){e.$set(e.form,"package_url",t)},expression:"form.package_url"}})],1)],1),e._v(" "),a("div",[e._v(e._s(e.form))]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addVersionUpdate}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.records,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"version",label:"更新版本",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"channel",label:"更新渠道",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("span",[e._v("启用")]):e._e(),e._v(" "),2==t.row.status?a("span",[e._v("禁用")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"modified_time",label:"更新时间",align:"center",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1)],1)},staticRenderFns:[]};var i=a("C7Lr")(n,o,!1,function(e){a("69j3")},"data-v-5e5cd278",null);t.default=i.exports}});