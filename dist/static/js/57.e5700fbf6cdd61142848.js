webpackJsonp([57],{"2WgX":function(t,e){},zAmQ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),i=a.n(n),o=a("iVUn"),l=a("fftp"),r=a("zhQY"),s=a("Z/hU"),c=a("2u00"),f=(a("y35B"),a("22Zk")),u=a("06fe"),_=(s.a,u.a,f.a,o.a,l.a,c.a,{name:"function_sort_config",extends:s.a,components:{InfoTableItem:u.a,InputArea:f.a,SelectTime:o.a,InfoTable:l.a,PermissionButton:c.a},data:function(){return{pagesize:10,currentPage:1,total:0,dialogTitle:"",value:!0,labelPosition:"left",dialogFormVisible:!1,platforms:[{value:1,label:"平台1"},{value:2,label:"平台2"}],format:{platform:""},funOpts:[],channelOpts:[],records:[],pageInfo:new r.a(0,[5,10,15],5),dialogAddVisible:!1,form:{checkList:[],active_1:"",active_2:"",active_3:"",active_4:"",active_5:"",active_6:"",active_7:"",active_8:""}}},methods:{formatFuncName:function(t){for(var e=0;e<this.funOpts.length;e++){var a=this.funOpts[e];if(a.id==t)return a.name}},resetForm:function(){this.form={id:null,checkList:[],active_1:"",active_2:"",active_3:"",active_4:"",active_5:"",active_6:"",active_7:"",active_8:""}},getFunSortList:function(){var t=this;this.$http.get("v1/backend/lobby/top",{params:{page:this.currentPage,limit:this.pagesize,type:2}}).then(function(e){console.log(e),1===e.data.code&&(t.records=e.data.data,t.total=e.data.total,t.func_list_index(),console.log(t.records))})},func_list_index:function(){this.records.map(function(t,e){JSON.parse(t.func_list).map(function(e,a){t["func_"+(a+1)]=e})})},search:function(){},openAddDialog:function(){this.dialogTitle="添加活动入口配置",this.dialogFormVisible=!0,this.resetForm(),this.getAddChannelList(),this.form.active_1=String(this.funOpts[0].id),this.form.active_2=String(this.funOpts[0].id),this.form.active_3=String(this.funOpts[0].id),this.form.active_4=String(this.funOpts[0].id),this.form.active_5=String(this.funOpts[0].id),this.form.active_6=String(this.funOpts[0].id),this.form.active_7=String(this.funOpts[0].id),this.form.active_8=String(this.funOpts[0].id)},addFunSortConf:function(){var t=this;if(this.form.id){var e=(this.form.active_1+","+this.form.active_2+","+this.form.active_3+","+this.form.active_4+","+this.form.active_5+","+this.form.active_6+","+this.form.active_7+","+this.form.active_8).split(","),a={name:this.form.checkList[0],code:this.form.checkList[0],list_id:i()(e),type:2,banner_id:this.form.id};this.$http.put("v1/backend/lobby/top",a).then(function(e){console.log(e),1===e.data.code&&(t.dialogFormVisible=!1,t.getFunSortList())})}else{var n=(this.form.active_1+","+this.form.active_2+","+this.form.active_3+","+this.form.active_4+","+this.form.active_5+","+this.form.active_6+","+this.form.active_7+","+this.form.active_8).split(","),o={name:this.form.checkList[0],code:this.form.checkList[0],list_id:i()(n),type:2};this.$http.post("v1/backend/lobby/top",o).then(function(e){console.log(e),1===e.data.code&&(t.dialogFormVisible=!1,t.getFunSortList())})}},handleEdit:function(t){console.log(t),this.dialogTitle="更新活动入口配置",this.dialogFormVisible=!0,this.getChannelList(),this.form.id=t.id,this.form.checkList=[t.channel_name],this.form.active_1=t.func_1,this.form.active_2=t.func_2,this.form.active_3=t.func_3,this.form.active_4=t.func_4,this.form.active_5=t.func_5,this.form.active_6=t.func_6,this.form.active_7=t.func_7,this.form.active_8=t.func_8},handleDelete:function(t){var e=this;console.log(t),this.$confirm("确认删除吗？","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.delete("v1/backend/lobby/top",{params:{id:t.id}}).then(function(t){console.log(t),1===t.data.code&&(e.getFunSortList(),e.$message({type:"success",message:t.data.msg}))})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},getAddChannelList:function(){var t=this;this.$http.post("v1/backend/no_channel",{type_id:1,add_id:1}).then(function(e){console.log(e),1===e.data.code&&(t.channelOpts=e.data.data)})},getChannelList:function(){var t=this;this.$http.post("v1/backend/no_channel",{type_id:2,add_id:1}).then(function(e){console.log(e),1===e.data.code&&(t.channelOpts=e.data.data)})},getActiveOpts:function(){var t=this;this.$http.get("v1/backend/lobby/name_type",{params:{type_id:3}}).then(function(e){console.log(e),1===e.data.code&&(t.funOpts=e.data.data)})},handleSizeChange:function(t){this.pagesize=t,this.currentPage=1,this.getFunSortList()},handleCurrentChange:function(t){this.currentPage=t,this.getFunSortList()}},mounted:function(){this.getFunSortList()},created:function(){this.getActiveOpts()}}),m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"FunSortConf-main"}},[a("input-area",[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"add_function_sort_config",expression:"'add_function_sort_config'"}],attrs:{type:"primary"},on:{click:t.openAddDialog}},[t._v("添加")])],1),t._v(" "),a("div",{staticClass:"bd"},[a("el-table",{directives:[{name:"has",rawName:"v-has",value:"function_sort_config_list",expression:"'function_sort_config_list'"}],staticStyle:{width:"100%"},attrs:{data:t.records,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"channel_name",label:"渠道名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"channel_code",label:"渠道KEY",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"活动1",prop:"func_1",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_1)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动2",prop:"func_2",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_2)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动3",prop:"func_3",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_3)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动4",prop:"func_4",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_4)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动5",prop:"func_5",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_5)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动6",prop:"func_6",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_6)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动7",prop:"func_7",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_7)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动8",prop:"func_8",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.formatFuncName(e.row.func_8)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作者",prop:"auth",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"create_time",align:"center",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"modify_function_sort_config",expression:"'modify_function_sort_config'"}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{directives:[{name:"has",rawName:"v-has",value:"delete_function_sort_config",expression:"'delete_function_sort_config'"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.currentPage,"page-sizes":[10,15,20],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("div",[a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form,"label-position":"top"}},[a("el-form-item",{attrs:{label:"渠道(可多选)"}},[a("el-checkbox-group",{attrs:{max:1},model:{value:t.form.checkList,callback:function(e){t.$set(t.form,"checkList",e)},expression:"form.checkList"}},t._l(t.channelOpts,function(e,n){return a("el-checkbox",{key:n,attrs:{label:e.channel_code}},[t._v(t._s(e.channel_name))])}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动1"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_1,callback:function(e){t.$set(t.form,"active_1",e)},expression:"form.active_1"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动2"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_2,callback:function(e){t.$set(t.form,"active_2",e)},expression:"form.active_2"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动3"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_3,callback:function(e){t.$set(t.form,"active_3",e)},expression:"form.active_3"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动4"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_4,callback:function(e){t.$set(t.form,"active_4",e)},expression:"form.active_4"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动5"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_5,callback:function(e){t.$set(t.form,"active_5",e)},expression:"form.active_5"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动6"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_6,callback:function(e){t.$set(t.form,"active_6",e)},expression:"form.active_6"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动7"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_7,callback:function(e){t.$set(t.form,"active_7",e)},expression:"form.active_7"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动8"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("活动名称")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.active_8,callback:function(e){t.$set(t.form,"active_8",e)},expression:"form.active_8"}},t._l(t.funOpts,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:String(t.id)}})}),1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addFunSortConf}},[t._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(_,m,!1,function(t){a("2WgX")},"data-v-4b6b8277",null);e.default=d.exports}});