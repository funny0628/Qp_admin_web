webpackJsonp([39],{"8N8t":function(t,e){},NXIz:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("lC5x"),r=a.n(n),i=a("J0Oq"),s=a.n(i),o={data:function(){return{tableData:[],title:"添加控制名单",visible:!1,form:{channel:"",stime:"",etime:""},rules:{},currentPage:1,limit:10,total:"",optionchannels:[]}},created:function(){this.initChannel(),this.getData()},methods:{add:function(){this.initform(!0,"添加控制名单",{})},send:function(){var t=this;return s()(r.a.mark(function e(){var a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.HallFunConfig.PostTableConfig({type_id:8});case 2:a=e.sent,n=a.data,console.log(n),1===n.code&&n.data&&t.$message({type:"success",message:"发送配置成功!"});case 6:case"end":return e.stop()}},e,t)}))()},handleEdit:function(t,e){var a={channel:e.channel,stime:1e3*e.stime,etime:1e3*e.etime,id:e.id};this.initform(!0,"编辑",a)},handleDel:function(t,e){var a=this;this.$confirm("确认删除吗?","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(s()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.$http.DataAnalysis.DeleterDdz({id:e.id});case 2:n=t.sent,n.data,a.getData(),a.$message({type:"success",message:"删除成功!"});case 6:case"end":return t.stop()}},t,a)}))).catch(function(){a.$message({type:"info",message:"已取消删除"})})},onSubmit:function(t,e){var a,n=this;this.$refs[t].validate((a=s()(r.a.mark(function t(a){var i,s,o,l,c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=20;break}if(i={channel:n.form.channel,stime:Math.ceil(n.form.stime/1e3),etime:Math.ceil(n.form.etime/1e3)},"添加控制名单"!==e){t.next=10;break}return t.next=5,n.$http.DataAnalysis.PostDdz(i);case 5:s=t.sent,1===(o=s.data).code&&"ok"===o.msg&&n.getData(),t.next=17;break;case 10:if("编辑"!==e){t.next=17;break}return i.id=n.form.id,t.next=14,n.$http.DataAnalysis.PutDdz(i);case 14:l=t.sent,1===(c=l.data).code&&"ok"===c.msg&&n.getData();case 17:n.initform(!1,"添加控制名单",{}),t.next=22;break;case 20:return console.log("error submit!!"),t.abrupt("return",!1);case 22:case"end":return t.stop()}},t,n)})),function(t){return a.apply(this,arguments)}))},handleSizeChange:function(t){this.limit=t,this.currentPage=1,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},initform:function(t,e,a){this.visible=t,this.title=e,this.form=a},initTime:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},getData:function(){this.initData({page:this.currentPage,limit:this.limit})},initData:function(t){var e=this;return s()(r.a.mark(function a(){var n,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$http.DataAnalysis.GetDdz(t);case 2:n=a.sent,i=n.data,console.log(i),i.data.forEach(function(t){t.s_etime=e.initTime(1e3*t.stime)+" - "+e.initTime(1e3*t.etime),t.op_time=e.initTime(1e3*t.op_time)}),console.log(i.data),e.tableData=i.data,e.total=i.total;case 9:case"end":return a.stop()}},a,e)}))()},initChannel:function(){var t=this;return s()(r.a.mark(function e(){var a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.OperationMan.GetChannels();case 2:a=e.sent,n=[],a.data.data.forEach(function(t){n.push(t.name)}),n.forEach(function(e,a){t.optionchannels.push({avator_nameO:e,levelO:a})}),t.optionchannels.unshift({avator_nameO:"所有渠道",levelO:-1});case 7:case"end":return e.stop()}},e,t)}))()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"L_PreventConfig"}},[a("div",{staticClass:"title"},[a("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("添加")]),a("el-button",{attrs:{type:"primary"},on:{click:t.send}},[t._v("发送配置")])],1),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"default-sort":{prop:"date",order:"descending"},data:t.tableData,border:""}},[a("el-table-column",{attrs:{sortable:"",align:"center",prop:"id",label:"编号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"channel",label:"渠道"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"s_etime",label:"有效时间",width:"300"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"op_time",label:"最后操作时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"op_name",label:"操作者"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDel(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),t.total>5?a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,15,20],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1),t._v(" "),a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{title:t.title,visible:t.visible,"destroy-on-close":!0},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"渠道",prop:"channel"}},[a("el-select",{staticStyle:{"margin-top":"10px",width:"200px"},attrs:{placeholder:"请选择渠道"},model:{value:t.form.channel,callback:function(e){t.$set(t.form,"channel",e)},expression:"form.channel"}},t._l(t.optionchannels,function(t){return a("el-option",{key:t.levelO,attrs:{label:t.avator_nameO,value:t.avator_nameO}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"有效时间 始",prop:"stime"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"timestamp"},model:{value:t.form.stime,callback:function(e){t.$set(t.form,"stime",e)},expression:"form.stime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"有效时间 止",prop:"etime"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"timestamp"},model:{value:t.form.etime,callback:function(e){t.$set(t.form,"etime",e)},expression:"form.etime"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form",t.title)}}},[t._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var c=a("C7Lr")(o,l,!1,function(t){a("8N8t")},"data-v-6a73fc00",null);e.default=c.exports}});