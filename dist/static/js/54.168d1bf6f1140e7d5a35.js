webpackJsonp([54],{kmL0:function(e,t){},ybfJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("iVUn"),r=a("fftp"),l=a("zhQY"),i=a("Z/hU"),n=a("2u00"),s=(a("y35B"),a("22Zk")),d=a("06fe"),c=(i.a,d.a,s.a,o.a,r.a,n.a,{name:"order_manage",extends:i.a,components:{InfoTableItem:d.a,InputArea:s.a,SelectTime:o.a,InfoTable:r.a,PermissionButton:n.a},data:function(){return{pagesize:5,currentPage:1,total:0,formLabelWidth:"120px",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},channelOpts:[{value:"ios",label:"ios"},{value:"android",label:"安卓"},{value:"window",label:"测试专用"}],orderStatus:[{value:"-1",label:"所有"},{value:"0",label:"已下单"},{value:"1",label:"已支付未处理"},{value:"2",label:"已支付已处理完成"},{value:"3",label:"已废弃"}],payOpts:[{value:"alipay",label:"支付宝"},{value:"wx",label:"微信支付"},{value:"qq",label:"QQ支付"},{value:"union",label:"银联"},{value:"gm",label:"人工订单"}],format:{channel:"",payment_method:"",order_id:"",status:"",user_id:"",dateArr:[new Date((new Date).getTime()-6048e5),new Date]},tableStyle:[{label:"用户ID",prop:"uid",width:""},{label:"订单号",prop:"order_id",width:""},{label:"付款方式",prop:"payment_channel",width:""},{label:"支付结果",prop:"status",width:""},{label:"异常原因",prop:"err_code",width:""},{label:"渠道",prop:"channel",width:""},{label:"商品名称",prop:"product_id",width:""},{label:"金额",prop:"amount",width:""},{label:"赠送金额",prop:"ex_coins",width:""},{label:"购买时间",prop:"create_time",width:""},{label:"操作",prop:"action",width:"170"}],records:[],optDetailTableData:[],pageInfo:new l.a(0,[5,10,15],5),dialogFormVisible:!1,dialogAbandonVisible:!1,dialogOptRecordVisible:!1,form:{user_id:"",pay_type:"人工充值",goods_type:100,money:"",check_money:""},abandonForm:{order_id:"",reason:""}}},methods:{searchData:function(){var e=this,t={page:this.currentPage,limit:this.pagesize,channel:this.format.channel,payment_method:this.format.payment_method,order_id:this.format.order_id,status:this.format.status?Number(this.format.status):-1,user_id:Number(this.format.user_id),start_time:this.format.dateArr?parseInt(new Date(Number(this.format.dateArr[0])).getTime()/1e3):0,end_time:this.format.dateArr?parseInt(new Date(Number(this.format.dateArr[1])).getTime()/1e3):0};console.log(t),this.$http.get("v1/backend/operation/orders",{params:t}).then(function(t){console.log(t),200===t.data.code&&(e.records=t.data.data,e.total=t.data.total)})},getOrderList:function(){var e=this,t={page:this.currentPage,limit:this.pagesize};this.$http.get("v1/backend/operation/orders",{params:t}).then(function(t){console.log(t),200===t.data.code&&(e.records=t.data.data,e.total=t.data.total)})},openPeopleDialog:function(){this.dialogFormVisible=!0,this.form={user_id:"",pay_type:"人工充值",goods_type:100,money:"",check_money:""}},addPeopleOrder:function(){var e=this,t={user_id:Number(this.form.user_id),amount:Number(this.form.money),confirmed_amount:Number(this.form.check_money)};this.$http.post("v1/backend/operation/orders",t).then(function(t){console.log(t),200===t.data.code&&(e.dialogFormVisible=!1,e.getOrderList())})},abandon:function(e){console.log(e),this.dialogAbandonVisible=!0,this.abandonForm.order_id=e.order_id},confirmDrop:function(){var e=this,t={order_id:this.abandonForm.order_id,desc:this.abandonForm.reason};this.$http.post("v1/backend/operation/order/detail",t).then(function(t){console.log(t),200===t.data.code&&(e.dialogAbandonVisible=!1,e.abandonForm={order_id:"",reason:""},e.getOrderList(),e.messages({type:"success",message:t.data.msg}))})},handleDetail:function(e){var t=this;console.log(e),this.dialogOptRecordVisible=!0,this.$http.get("v1/backend/operation/order/detail",{params:{order_id:e.order_id}}).then(function(e){console.log(e),200===e.data.code&&(t.optDetailTableData=e.data.data)})},search:function(){var e=this.format;this.userList(e,1e3)},handleSizeChange:function(e){this.pagesize=e,this.getOrderList()},handleCurrentChange:function(e){this.currentPage=e,this.getOrderList()}},mounted:function(){this.getOrderList()}}),p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"OrderMan-main"}},[a("input-area",[a("span",[e._v("渠道名")]),e._v(" "),a("el-select",{attrs:{placeholder:"渠道名",clearable:"",size:"medium"},model:{value:e.format.channel,callback:function(t){e.$set(e.format,"channel",t)},expression:"format.channel"}},e._l(e.channelOpts,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("span",[e._v("订单号")]),e._v(" "),a("el-input",{attrs:{placeholder:"请输入订单号查询",size:"medium",clearable:""},model:{value:e.format.order_id,callback:function(t){e.$set(e.format,"order_id",t)},expression:"format.order_id"}}),e._v(" "),a("span",[e._v("支付方式")]),e._v(" "),a("el-select",{attrs:{placeholder:"支付方式",clearable:"",size:"medium"},model:{value:e.format.payment_method,callback:function(t){e.$set(e.format,"payment_method",t)},expression:"format.payment_method"}},e._l(e.payOpts,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("span",[e._v("订单状态")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"状态",size:"medium",clearable:""},model:{value:e.format.status,callback:function(t){e.$set(e.format,"status",t)},expression:"format.status"}},e._l(e.orderStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-input",{attrs:{placeholder:"请输入用户id",size:"medium",clearable:""},model:{value:e.format.user_id,callback:function(t){e.$set(e.format,"user_id",t)},expression:"format.user_id"}}),e._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right",clearable:!1},model:{value:e.format.dateArr,callback:function(t){e.$set(e.format,"dateArr",t)},expression:"format.dateArr"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.searchData}},[e._v("查找")]),e._v(" "),a("el-button",{directives:[{name:"has",rawName:"v-has",value:"add_order",expression:"'add_order'"}],attrs:{type:"primary"},on:{click:e.openPeopleDialog}},[e._v("添加人工订单")]),e._v(" "),a("el-button",{attrs:{type:"primary"}},[e._v("导出excel")])],1),e._v(" "),a("div",{staticClass:"bd"},[a("info-table",{directives:[{name:"has",rawName:"v-has",value:"order_list",expression:"'order_list'"}],attrs:{search:e.search,"table-style":e.tableStyle,records:e.records,"page-info":e.pageInfo,"hide-page":!0}},[a("info-table-item",{attrs:{"table-style":e.tableStyle,"hide-mul":!0},scopedSlots:e._u([{key:"default",fn:function(t){return["status".indexOf(t.prop)>=0?[0===t.row.status?a("span",[e._v("已下单")]):e._e(),e._v(" "),1===t.row.status?a("span",[e._v("已支付未处理")]):e._e(),e._v(" "),2===t.row.status?a("span",[e._v("已支付已处理完成")]):e._e(),e._v(" "),3===t.row.status?a("span",[e._v("已废弃")]):e._e()]:e._e(),e._v(" "),"payment_channel".indexOf(t.prop)>=0?["alipay"==t.row[t.prop]?a("span",[e._v("支付宝")]):e._e(),e._v(" "),"wx"==t.row[t.prop]?a("span",[e._v("微信支付")]):e._e(),e._v(" "),"qq"==t.row[t.prop]?a("span",[e._v("QQ支付")]):e._e(),e._v(" "),"union"==t.row[t.prop]?a("span",[e._v("银联")]):e._e(),e._v(" "),"gm"==t.row[t.prop]?a("span",[e._v("人工订单")]):e._e()]:e._e(),e._v(" "),"create_time".indexOf(t.prop)>=0?[a("span",[e._v(e._s(e._f("dateFormat")(t.row.create_time)))])]:e._e(),e._v(" "),"action"===t.prop?[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"order_forbidden",expression:"'order_forbidden'"}],staticStyle:{"background-color":"#01c8ae",color:"#fff"},attrs:{size:"mini"},on:{click:function(a){return e.abandon(t.row)}}},[e._v("废弃")]),e._v(" "),a("el-button",{directives:[{name:"has",rawName:"v-has",value:"order_detail",expression:"'order_detail'"}],staticStyle:{"background-color":"#01c8ae",color:"#fff"},attrs:{size:"mini"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v("操作详情")])]:e._e(),e._v(" "),["action","status","payment_channel","create_time"].indexOf(t.prop)<0?[e._v(e._s(t.row[t.prop]))]:e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加人工订单",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"用户id","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户id"},model:{value:e.form.user_id,callback:function(t){e.$set(e.form,"user_id",t)},expression:"form.user_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"付款方式","label-width":e.formLabelWidth}},[a("el-input",{attrs:{disabled:"",autocomplete:"off",placeholder:"人工充值"},model:{value:e.form.pay_type,callback:function(t){e.$set(e.form,"pay_type",t)},expression:"form.pay_type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"金额","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"请输入金额"},model:{value:e.form.money,callback:function(t){e.$set(e.form,"money",e._n(t))},expression:"form.money"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认金额","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"请确认输入金额"},model:{value:e.form.check_money,callback:function(t){e.$set(e.form,"check_money",e._n(t))},expression:"form.check_money"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addPeopleOrder}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"废弃原因",visible:e.dialogAbandonVisible,width:"30%"},on:{"update:visible":function(t){e.dialogAbandonVisible=t}}},[a("el-form",{staticStyle:{"margin-bottom":"20px"},attrs:{model:e.abandonForm}},[a("el-input",{attrs:{type:"textarea",rows:4,autocomplete:"off"},model:{value:e.abandonForm.reason,callback:function(t){e.$set(e.abandonForm,"reason",t)},expression:"abandonForm.reason"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAbandonVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDrop}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"操作记录",visible:e.dialogOptRecordVisible},on:{"update:visible":function(t){e.dialogOptRecordVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.optDetailTableData,border:""}},[a("el-table-column",{attrs:{prop:"type",label:"类型",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?a("span",[e._v("人工订单添加")]):e._e(),e._v(" "),0===t.row.type?a("span",[e._v("废弃")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"uid",label:"操作人",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"操作时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("dateFormat")(t.row.create_time)))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"操作ip",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"city",label:"地区",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"des",label:"备注",align:"center"}})],1)],1)],1)},staticRenderFns:[]};var m=a("C7Lr")(c,p,!1,function(e){a("kmL0")},"data-v-50c39260",null);t.default=m.exports}});
//# sourceMappingURL=54.168d1bf6f1140e7d5a35.js.map